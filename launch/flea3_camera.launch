<launch>
  <arg name="LAUNCH_FLEA3" default="true" />
   <!-- Determine this using rosrun pointgrey_camera_driver list_cameras.
       If not specified, defaults to first camera found. -->
  <arg name="camera_serial_left" default="14160044" />
  <arg name="camera_serial_right" default="14160053" />
  <!-- <arg name="calibrated" default="0" /> -->


  <group ns = "flea3_camera" >
    <group if="$(arg LAUNCH_FLEA3)" >
      <node pkg="nodelet" type="nodelet" name="camera_nodelet_manager" args="manager" />
      <group ns="left">
        <node pkg="nodelet" type="nodelet" name="camera_nodelet"
              args="load pointgrey_camera_driver/PointGreyCameraNodelet /flea3_camera/camera_nodelet_manager" >
          <param name="frame_id" value="camera" />
          <param name="serial" value="$(arg camera_serial_left)" />

          <!-- When unspecified, the driver will use the default framerate as given by the
               camera itself. Use this parameter to override that value for cameras capable of
               other framerates. -->
          <!-- <param name="frame_rate" value="15" /> -->

          <!-- Use the camera_calibration package to create this file -->
          <param name="camera_info_url"
                 value="file://$(find baseball)/config/flea3_left.yaml" />
        </node>

        <!-- <node pkg="nodelet" type="nodelet" name="image_proc_debayer" -->
        <!--       args="load image_proc/debayer /flea3_camera/camera_nodelet_manager"> -->
        <!-- </node> -->
      </group>

      <group ns="right">
        <node pkg="nodelet" type="nodelet" name="camera_nodelet"
              args="load pointgrey_camera_driver/PointGreyCameraNodelet /flea3_camera/camera_nodelet_manager" >
          <param name="frame_id" value="camera" />
          <param name="serial" value="$(arg camera_serial_right)" />

          <!-- When unspecified, the driver will use the default framerate as given by the
               camera itself. Use this parameter to override that value for cameras capable of
               other framerates. -->
          <!-- <param name="frame_rate" value="15" /> -->

          <!-- Use the camera_calibration package to create this file -->
          <param name="camera_info_url"
                 value="file://$(find baseball)/config/flea3_right.yaml" />
        </node>

        <!-- <node pkg="nodelet" type="nodelet" name="image_proc_debayer" -->
        <!--       args="load image_proc/debayer /flea3_camera/camera_nodelet_manager"> -->
        <!-- </node> -->

        <!-- Show image_view -->
        <node name="flea3_image_view" pkg="rqt_gui" type="rqt_gui" output="screen" />
      </group>
    </group>

    <!-- stereo proc -->
    <node name="stereo_proc" pkg="stereo_image_proc" type="stereo_image_proc"
          respawn="false" output="screen" >
      <param name="approximate_sync" value="true" />
      <param name="disparity_range" value="200" />
      <param name="min_disparity" value="0" />
      <param name="correlation_window_size" value="20" />
      <param name="uniqueness_ratio" value="12" />
      <param name="speckle_range" value="4" />
      <param name="speckle_size" value="100" />
      <param name="texture_threshold" value="9" />
    </node>

  </group>
</launch>
